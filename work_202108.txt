Add tests
Add logging
Fix bug in authentication
