Add tests
Add tests
Fix bug in authentication
