Fix bug in authentication
Fix edge case
