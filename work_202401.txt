Fix bug in authentication
Add tests
Optimize algorithm
Add tests
