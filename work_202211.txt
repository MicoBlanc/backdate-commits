Add tests
Improve error handling
Update documentation
