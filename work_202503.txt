Add logging
Improve performance
Fix typo
