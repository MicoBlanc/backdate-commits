Fix edge case
Improve error handling
